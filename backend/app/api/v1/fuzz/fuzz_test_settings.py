from fastapi import APIRouter, Depends, HTTPException, status, Request

from backend.app.common.jwt import DependsJwtAuth
from backend.app.common.response.response_schema import response_base
from backend.app.services.fuzz_test_settings_service import FuzzTestSettingsService
from backend.app.utils.helper_output import sqlalchemy_list2dict


router = APIRouter()

@router.get('/read/case/library', summary="读取模糊测试用例库", dependencies=[DependsJwtAuth])
async def read_case_library(request: Request):
    
    # 读取系统内置的所有模糊测试用例组
    groups: list = await FuzzTestSettingsService.read_case_library(request)
    data = sqlalchemy_list2dict(groups)
    print(data)
    return await response_base.success(data=data)