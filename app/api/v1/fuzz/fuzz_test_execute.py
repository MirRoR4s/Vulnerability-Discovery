from fastapi import APIRouter, Request, BackgroundTasks
from fastapi.responses import RedirectResponse
from app.common.jwt import DependsJwtAuth
from app.services.fuzz_test_execute_service import FuzzTestExecuteService

router = APIRouter()

@router.get('/execute', summary='执行模糊测试', dependencies=[DependsJwtAuth])
async def execute(request: Request, ip: str, port: int, suite_name: str, background_tasks: BackgroundTasks):
    # 将 FuzzTestExecuteService.execute 函数添加到后台任务
    background_tasks.add_task(FuzzTestExecuteService.execute, request, ip, port, suite_name)
    return "模糊测试开始执行"

